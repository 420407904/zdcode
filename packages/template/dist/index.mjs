import d from"chalk";import{getProjectJsonFile as F}from"@zdcode/utils";import f from"inquirer";async function g(t,n){let{action:e}=await f.prompt([{name:"action",type:"list",message:t,choices:n}]);return e}var u=async t=>{let{action:n}=await f.prompt([{name:"action",type:"input",message:t}]);return n};import x from"path";import y from"chalk";import{writeFile as T,getProjectFile as C}from"@zdcode/utils";function h(t){return t.charAt(0).toUpperCase()+t.slice(1)}function $(t){return t.charAt(0).toLowerCase()+t.slice(1)}var w={F:h,f:$},p=(t,n)=>{let e=t.match(/(\$T\{)([A-Za-z | _])+(\})/g);return e&&(e=Array.from(new Set(e)),e.map(o=>{let s=o.slice(3).slice(0,-1).split("|");return{content:o,formats:s.slice(0,-1),name:s.slice(-1)[0]}}).forEach(({content:o,formats:s,name:i})=>{let r=n[i];for(let m of s)w[m]&&(r=w[m](r));t=t.replace(new RegExp(o.replace("$","\\$").replace("{","\\{").replace("}","\\}").replace("|","\\|"),"g"),r)})),t};var l=async(t,n,e)=>{for(let a of n){let o=p(a.name,e);if(a.files){await l(`${t}/${o}`,a.files,e);return}if(a.template){let s=a.template,i=C(`.templates/${s}`),c=p(i,e);await T(x.resolve(process.cwd(),`${t}/${o}`),c),console.log("\u{1F389}",y.gray(`${t}/${o}`))}}};var v=t=>{t.command("template").description("\u5FEB\u901F\u521B\u5EFA\u6A21\u677F\u6587\u4EF6").action(async()=>{let n=F(".templates/template.json"),e=await g("\u8BF7\u9009\u62E9\u6A21\u677F",n.map(({name:r})=>({name:r,value:r}))),a=n.find(({name:r})=>r===e);if(!a)throw new Error("\u6A21\u677F\u5F02\u5E38\uFF01");let{params:o=[],root:s,templates:i}=a,c={};if(o.length)for(let r of o){let m=await u(`\u8BF7\u8F93\u5165 ${r}:`);c[r]=m}console.log(""),console.log("\u{1F433}",d.gray("\u5F00\u59CB\u751F\u6210\u6A21\u677F\u6587\u4EF6")),console.log(""),await l(s,i,c),console.log(""),console.log("\u{1F433}",d.green("success!")),console.log("")})},J=v;export{J as default};
