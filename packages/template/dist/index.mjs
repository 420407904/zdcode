import{getProjectJsonFile as C}from"@zdcode/utils";import f from"inquirer";async function g(t,r){let{action:e}=await f.prompt([{name:"action",type:"list",message:t,choices:r}]);return e}var u=async t=>{let{action:r}=await f.prompt([{name:"action",type:"input",message:t}]);return r};import x from"path";import{writeFile as $,getProjectFile as T}from"@zdcode/utils";function d(t){return t.charAt(0).toUpperCase()+t.slice(1)}function h(t){return t.charAt(0).toLowerCase()+t.slice(1)}var w={F:d,f:h},c=(t,r)=>{let e=t.match(/(\$T\{)([A-Za-z | _])+(\})/g);return e&&(e=Array.from(new Set(e)),e.map(n=>{let i=n.slice(3).slice(0,-1).split("|");return{content:n,formats:i.slice(0,-1),name:i.slice(-1)[0]}}).forEach(({content:n,formats:i,name:s})=>{let o=r[s];for(let p of i)w[p]&&(o=w[p](o));t=t.replace(new RegExp(n.replace("$","\\$").replace("{","\\{").replace("}","\\}").replace("|","\\|"),"g"),o)}),console.log("str",t)),t};var l=(t,r,e)=>{for(let a of r){let n=c(a.name,e);if(a.files){l(`${t}/${n}`,a.files,e);return}if(a.template){let i=a.template,s=T(`.templates/${i}`),m=c(s,e);$(x.resolve(process.cwd(),`${t}/${n}`),m)}}};var F=t=>{t.command("template").description("\u5FEB\u901F\u521B\u5EFA\u6A21\u677F\u6587\u4EF6").action(async()=>{let r=C(".templates/template.json"),e=await g("\u8BF7\u9009\u62E9\u6A21\u677F",r.map(({name:o})=>({name:o,value:o}))),a=r.find(({name:o})=>o===e);if(!a)throw new Error("\u6A21\u677F\u5F02\u5E38\uFF01");let{params:n=[],root:i,templates:s}=a,m={};if(n.length)for(let o of n){let p=await u(`\u8BF7\u8F93\u5165 ${o}:`);m[o]=p}l(i,s,m)})},k=F;export{k as default};
