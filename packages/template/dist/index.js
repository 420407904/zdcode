"use strict";var z=Object.create;var d=Object.defineProperty;var B=Object.getOwnPropertyDescriptor;var D=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var Z=(t,o)=>{for(var e in o)d(t,e,{get:o[e],enumerable:!0})},b=(t,o,e,r)=>{if(o&&typeof o=="object"||typeof o=="function")for(let a of D(o))!N.call(t,a)&&a!==e&&d(t,a,{get:()=>o[a],enumerable:!(r=B(o,a))||r.enumerable});return t};var w=(t,o,e)=>(e=t!=null?z(J(t)):{},b(o||!t||!t.__esModule?d(e,"default",{value:t,enumerable:!0}):e,t)),_=t=>b(d({},"__esModule",{value:!0}),t);var I={};Z(I,{default:()=>H});module.exports=_(I);var A=w(require("chalk")),L=require("@zdcode/utils");var T=w(require("inquirer"));async function F(t,o){let{action:e}=await T.default.prompt([{name:"action",type:"list",message:t,choices:o}]);return e}var j=async t=>{let{action:o}=await T.default.prompt([{name:"action",type:"input",message:t}]);return o},E=async(t,o)=>{let{action:e}=await T.default.prompt([{name:"action",type:"confirm",message:t,default:o}]);return e};var R=w(require("fs")),C=w(require("path")),h=w(require("chalk")),g=require("@zdcode/utils");var f=require("@zdcode/utils"),P={F:f.upperFirstLetter,f:f.lowerFirstLetter,"-":f.humpToChain},x=(t,o,e)=>t.replace(new RegExp(o.replace("$","\\$").replace("{","\\{").replace("}","\\}").replace("|","\\|"),"g"),e),y=(t,o)=>{let e=t.match(/(\$T\{)([A-Za-z|_|:|-])+(\})/g);return e&&(e=Array.from(new Set(e)),e.map(a=>{let c=a.slice(3).slice(0,-1).split("|");return{content:a,formats:c.slice(0,-1),name:c.slice(-1)[0]}}).forEach(({content:a,formats:c,name:p})=>{let s=o[p];if(!s)return;let n=s;for(let i of c)P[i]&&(n=P[i](n));t=x(t,a,n)})),t};var v=async(t,o,e)=>{for(let r of o){let a=r.root,c=r.name&&y(r.name,e),p=[t,a,c].filter(Boolean).join("/").replace(/\/\//g,"/");if(r.files){await v(p,r.files,e);continue}if(r.type==="replace"){let{replaceFile:s,replaceOptions:n}=r;if(!s||!n)continue;let i=C.default.join(p,s),l=(0,g.getProjectFile)(i);for(let $ of n){let{target:m,template:u,content:k}=$;if(!m)throw new Error("\u8BF7\u6307\u5B9A\u8981\u66FF\u6362\u5185\u5BB9\u7684\u6587\u4EF6\u8DEF\u5F84\uFF01");if(!u&&!k)throw new Error("\u8BF7\u6307\u5B9A\u8981\u66FF\u6362\u7684\u5185\u5BB9\uFF01");let S=(0,g.getProjectFile)(`.templates/${u}`),O=y(m,e),q=x(l,`// $T{${O}}`,`// $T{${O}}
${y(S,e)}`);R.default.writeFileSync(i,q,"utf8")}console.log("\u{1F389}",h.default.blue("replace"),h.default.gray(i))}if(r.template){let s=r.template,n=(0,g.getProjectFile)(`.templates/${s}`),i=y(n,e);await(0,g.writeFile)(C.default.resolve(process.cwd(),p),i),console.log("\u{1F389}",h.default.blue("create "),h.default.gray(p))}}};var G=t=>{t.command("template").description("\u5FEB\u901F\u521B\u5EFA\u6A21\u677F\u6587\u4EF6").action(async()=>{let o=(0,L.getProjectJsonFile)(".templates/template.json"),e=await F("\u8BF7\u9009\u62E9\u6A21\u677F",o.map(({name:n})=>({name:n,value:n}))),r=o.find(({name:n})=>n===e);if(!r)throw new Error("\u6A21\u677F\u5F02\u5E38\uFF01");let{params:a=[],root:c,templates:p}=r,s={};if(a.length)for(let n of a){if(typeof n=="string"){let i=await j(`\u8BF7\u8F93\u5165 ${n}:`);s[n]=i}if(Array.isArray(n)){let[i,l]=n;if(typeof l=="string"&&l==="boolean"){let m=await E(`${i}?`);s[i]=m}if(Array.isArray(l)){let $=l,m=await F(`\u8BF7\u9009\u62E9 ${i}`,$.map(u=>({name:u,value:u})));s[i]=m}}}console.log(""),console.log("\u{1F433}",A.default.gray("\u5F00\u59CB\u751F\u6210\u6A21\u677F\u6587\u4EF6")),console.log(""),await v(c,p,s),console.log(""),console.log("\u{1F433}",A.default.green("success!")),console.log("")})},H=G;0&&(module.exports={});
