"use strict";var E=Object.create;var p=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var K=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty;var b=(e,t)=>{for(var r in t)p(e,r,{get:t[r],enumerable:!0})},T=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of F(t))!S.call(e,n)&&n!==r&&p(e,n,{get:()=>t[n],enumerable:!(o=D(t,n))||o.enumerable});return e};var d=(e,t,r)=>(r=e!=null?E(K(e)):{},T(t||!e||!e.__esModule?p(r,"default",{value:e,enumerable:!0}):r,e)),k=e=>T(p({},"__esModule",{value:!0}),e);var q={};b(q,{arr2Dic:()=>v,checkExist:()=>m,createDir:()=>x,createFile:()=>J,flattenDeepByField:()=>j,getAllSettledPromiseData:()=>W,getProjectFile:()=>O,getProjectJsonFile:()=>N,getPromiseData:()=>B,getSettledData:()=>P,mapFields:()=>A,sortAsc:()=>R,sortDesc:()=>$,writeFile:()=>C});module.exports=k(q);var f=require("lodash"),v=function(e=[],t,r){let o={};return Array.isArray(t)?e.forEach(n=>{o[n[t[0]]]=r?Object.assign(n,(0,f.clone)(r)):n[t[1]]}):e.forEach(n=>{o[n[t]]=r?Object.assign(n,(0,f.clone)(r)):n}),o},R=function(e,t){function r(o){return function(n,i){var s=o?n[o]:n,c=o?i[o]:i;if(typeof s=="number"&&typeof c=="number")return s-c}}return e.sort(r(t))},$=function(e,t){function r(o){return function(n,i){var s=o?n[o]:n,c=o?i[o]:i;if(typeof s=="number"&&typeof c=="number")return c-s}}return e.sort(r(t))},j=(e,t)=>{let r=o=>o[t]?[o,o[t].map(r)]:o;return(0,f.flattenDeep)(e.map(r))},A=(e,t)=>e.map(r=>{let o={};return t.forEach(n=>{o[n]=r[n]}),o});var g=d(require("path")),a=d(require("fs")),O=e=>{let t=g.default.resolve(process.cwd(),e);return a.default.readFileSync(t,{encoding:"utf-8"})},N=e=>{let t=g.default.resolve(process.cwd(),e),r=a.default.readFileSync(t,{encoding:"utf-8"});try{return JSON.parse(r)}catch{return{}}},m=e=>new Promise((t,r)=>{a.default.access(e,o=>{t(!o)})}),C=async(e,t,r)=>{if(await m(e))return console.log("\u26A0\uFE0F \u6587\u4EF6\u5DF2\u5B58\u5728\uFF1A",e);let n=e.split("/"),i=n[n.length-1],s=e.replace(RegExp(`${i}$`),"");await x(s,{basePath:r}),a.default.writeFileSync(e,t,"utf8")},x=async(e,t)=>{let{basePath:r=""}=t||{};RegExp(`^${r}`).test(e)||console.warn("\u4F20\u5165\u591A\u8DEF\u5F84\u4E0D\u662F\u4EE5",r,"\u5F00\u5934\uFF0C\u914D\u7F6E\u65E0\u6548\uFF01");let n=e.replace(r,"").replace(/^\//,"").split("/");for(;n.length;){let i=n.shift(),s=`${r}/${i}`,c=await m(s);try{c||a.default.mkdirSync(s)}catch(l){if(l&&l.message&&!l.message.includes("file already exists"))throw new Error(l)}finally{r=s}}},J=async(e,t,r)=>{if(await m(e))return console.log("\u26A0\uFE0F \u6587\u4EF6\u5DF2\u5B58\u5728\uFF1A",e);let n=e.split("/"),i=n[n.length-1],s=e.replace(RegExp(`${i}$`),"");return await x(s,{basePath:r}),new Promise((c,l)=>{let w=a.default.createReadStream(t.path),u=a.default.createWriteStream(e);w.pipe(u);let y=!1;u.on("error",h=>{y=!0,u.destroy(),l(h)}),u.on("finish",()=>{y||(c("finish"),u.close())})})};var B=e=>e.then(t=>[t]).catch(t=>[null,t]),P=(e,t=!0)=>{if(e.status==="fulfilled")return[e.value];if(t)throw new Error(e.reason);return[null,e.reason]},W=(e,t=!0)=>e.map(r=>P(r,t));0&&(module.exports={arr2Dic,checkExist,createDir,createFile,flattenDeepByField,getAllSettledPromiseData,getProjectFile,getProjectJsonFile,getPromiseData,getSettledData,mapFields,sortAsc,sortDesc,writeFile});
